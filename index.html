
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>T2-C Wartungsprotokoll ‚Äì PRO</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; background-color: #f8f9fa; }
    h1 { color: #333; }
    label { font-weight: bold; display: block; margin-top: 15px; }
    select, input[type="text"], button, textarea { width: 100%; padding: 10px; margin-top: 5px; font-size: 16px; }
    .row { display: flex; gap: 20px; flex-wrap: wrap; }
    .half { flex: 1; min-width: 220px; }
    .log-table { width: 100%; border-collapse: collapse; margin-top: 30px; }
    .log-table th, .log-table td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    .log-table th { background-color: #eaeaea; }
    .btn { background-color: #4CAF50; color: white; border: none; cursor: pointer; margin-top: 20px; }
    .btn:hover { background-color: #45a049; }
    .dashboard, .chart-box { margin-top: 30px; padding: 15px; background-color: #eef; border-radius: 5px; }
    .dashboard div { margin: 5px 0; font-weight: bold; }
    .search-box { margin-top: 20px; }
  </style>
</head>
<body>

<h1>üßæ T2-C Wartungsprotokoll ‚Äì PRO Version</h1>

<div class="dashboard">
  <div><strong>üìä Live-Z√§hler:</strong></div>
  <div id="counter-gelb">Gelb gewechselt: 0√ó</div>
  <div id="counter-gruen">Gr√ºn gewechselt: 0√ó</div>
  <div id="counter-lila">Lila gewechselt: 0√ó</div>
  <div id="counter-schwarz">Schwarz gewechselt: 0√ó</div>
</div>

<div class="row">
  <div class="half">
    <label for="drucker">Drucker w√§hlen:</label>
    <select id="drucker">
      <option value="T2-C Drucker 1">T2-C Drucker 1</option>
      <option value="T2-C Drucker 2">T2-C Drucker 2</option>
    </select>
  </div>
  <div class="half">
    <label for="personal">Personal:</label>
    <select id="personal">
      <option value="Mitarbeiter A">Mitarbeiter A</option>
      <option value="Mitarbeiter B">Mitarbeiter B</option>
      <option value="Mitarbeiter C">Mitarbeiter C</option>
    </select>
  </div>
</div>

<label for="aktion">Was wurde gemacht?</label>
<select id="aktion">
  <option value="Farbwechsel">Farbwechsel</option>
  <option value="Wiper gewechselt">Wiper gewechselt</option>
  <option value="Druckkopf gewechselt">Druckkopf gewechselt</option>
</select>

<label for="seriennummer">Seriennummer:</label>
<input type="text" id="seriennummer" placeholder="z.‚ÄØB. T2C-123456" />

<label for="leistung">Leistung beim Wechsel (z.‚ÄØB. Auftr√§ge):</label>
<input type="text" id="leistung" placeholder="z.‚ÄØB. 120000 Etiketten" />

<label>Welche Farbe(n)?</label>
<div>
  <label><input type="checkbox" value="Gelb" class="farbe"> Gelb</label>
  <label><input type="checkbox" value="Gr√ºn" class="farbe"> Gr√ºn</label>
  <label><input type="checkbox" value="Lila" class="farbe"> Lila</label>
  <label><input type="checkbox" value="Schwarz" class="farbe"> Schwarz</label>
</div>

<label for="fehler">Fehler (optional):</label>
<select id="fehler">
  <option value="">‚Äì Kein Fehler ‚Äì</option>
  <option value="Printhead Unprimed">Printhead Unprimed</option>
  <option value="Maintenance Jam">Maintenance Jam</option>
  <option value="NIP Open">NIP Open</option>
  <option value="Fehler NA">Fehler NA</option>
</select>

<label for="bemerkung">Bemerkung:</label>
<textarea id="bemerkung" rows="3" placeholder="Zus√§tzliche Hinweise oder Fehlerbeschreibung..."></textarea>

<button class="btn" onclick="eintragHinzufuegen()">‚ûï Eintrag speichern</button>
<button class="btn" onclick="alsPDFExportieren()">üìÑ Exportieren als PDF</button>

<div class="search-box">
  <label for="suchfeld">üîç Suchen (z.‚ÄØB. nach Drucker oder Farbe):</label>
  <input type="text" id="suchfeld" onkeyup="sucheInTabelle()" placeholder="Suchbegriff eingeben..." />
</div>

<table class="log-table" id="wartungsliste">
  <thead>
    <tr>
      <th>Datum</th>
      <th>Uhrzeit</th>
      <th>Drucker</th>
      <th>Aktion</th>
      <th>Seriennummer</th>
      <th>Farben</th>
      <th>Leistung</th>
      <th>Fehler</th>
      <th>Personal</th>
      <th>Bemerkung</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="chart-box">
  <h3>üìà Farbwechsel-Statistik</h3>
  <canvas id="colorChart" width="600" height="300"></canvas>
</div>

<script>
let zaehler = { "Gelb": 0, "Gr√ºn": 0, "Lila": 0, "Schwarz": 0 };

function eintragHinzufuegen() {
  const jetzt = new Date();
  const datum = jetzt.toLocaleDateString();
  const zeit = jetzt.toLocaleTimeString();
  const drucker = document.getElementById("drucker").value;
  const personal = document.getElementById("personal").value;
  const seriennummer = document.getElementById("seriennummer").value;
  const aktion = document.getElementById("aktion").value;
  const leistung = document.getElementById("leistung").value;
  const fehler = document.getElementById("fehler").value;
  const bemerkung = document.getElementById("bemerkung").value;
  const farbenListe = [...document.querySelectorAll(".farbe:checked")].map(cb => cb.value);
  const farben = farbenListe.join(", ");

  farbenListe.forEach(farbe => { if (zaehler[farbe] !== undefined) zaehler[farbe]++; });
  updateDashboard();

  const table = document.getElementById("wartungsliste").getElementsByTagName("tbody")[0];
  const newRow = table.insertRow();
  [datum, zeit, drucker, aktion, seriennummer, farben, leistung, fehler, personal, bemerkung].forEach((text, idx) => {
    const cell = newRow.insertCell(idx);
    cell.textContent = text;
  });

  // Reset
  document.getElementById("seriennummer").value = "";
  document.getElementById("leistung").value = "";
  document.getElementById("bemerkung").value = "";
  document.querySelectorAll(".farbe").forEach(cb => cb.checked = false);
  document.getElementById("fehler").value = "";

  updateChart();
}

function updateDashboard() {
  document.getElementById("counter-gelb").textContent = `Gelb gewechselt: ${zaehler["Gelb"]}√ó`;
  document.getElementById("counter-gruen").textContent = `Gr√ºn gewechselt: ${zaehler["Gr√ºn"]}√ó`;
  document.getElementById("counter-lila").textContent = `Lila gewechselt: ${zaehler["Lila"]}√ó`;
  document.getElementById("counter-schwarz").textContent = `Schwarz gewechselt: ${zaehler["Schwarz"]}√ó`;
}

function alsPDFExportieren() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.text("T2-C Wartungsprotokoll", 14, 15);
  const rows = [];
  document.querySelectorAll("#wartungsliste tbody tr").forEach(row => {
    const rowData = [];
    row.querySelectorAll("td").forEach(cell => rowData.push(cell.textContent));
    rows.push(rowData);
  });
  doc.autoTable({
    head: [["Datum", "Uhrzeit", "Drucker", "Aktion", "Seriennummer", "Farben", "Leistung", "Fehler", "Personal", "Bemerkung"]],
    body: rows,
    startY: 25
  });
  doc.save("T2C_Wartung.pdf");
}

function sucheInTabelle() {
  const input = document.getElementById("suchfeld").value.toLowerCase();
  const rows = document.querySelectorAll("#wartungsliste tbody tr");
  rows.forEach(row => {
    const match = [...row.children].some(cell => cell.textContent.toLowerCase().includes(input));
    row.style.display = match ? "" : "none";
  });
}

// Chart-Auswertung
let chart;
function updateChart() {
  const ctx = document.getElementById("colorChart").getContext("2d");
  if (chart) chart.destroy();
  chart = new Chart(ctx, {
    type: "bar",
    data: {
      labels: ["Gelb", "Gr√ºn", "Lila", "Schwarz"],
      datasets: [{
        label: "Anzahl Farbwechsel",
        data: [zaehler["Gelb"], zaehler["Gr√ºn"], zaehler["Lila"], zaehler["Schwarz"]],
        backgroundColor: ["#FFD700", "#66CC66", "#CC66CC", "#333"]
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true, ticks: { stepSize: 1 } }
      }
    }
  });
}
</script>
</body>
</html>
